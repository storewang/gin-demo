# GO 工程化项目目录结构

## 推荐目录
### 1. /cmd
> 我们一般采用 /cmd/[appname]/main.go  的形式进行组织

    1.  首先 cmd 目录下一般是项目的主干目录
    2.  这个目录下的文件不应该有太多的代码，不应该包含业务逻辑
    3.  main.go 当中主要做的事情就是负责程序的生命周期，服务所需资源的依赖注入等
    4.  业务处理分包    
![分包图](https://img.lailin.xyz/image/1612614638378-d00b94ac-f743-414e-bca2-b9d941da7902.png)
### 2. /internal
> internal 目录下的包，不允许被其他项目中进行导入，这是在 Go 1.4 当中引入的 feature，会在编译时执行

    1.  所以我们一般会把项目文件夹放置到 internal 当中，例如 /internal/app
    2.  如果是可以被其他项目导入的包我们一般会放到 pkg 目录下
    3.  如果是我们项目内部进行共享的包，而不期望外部共享，我们可以放到 /internal/pkg  当中
    4.  注意 internal 目录的限制并不局限于顶级目录，在任何目录当中都是生效的
### 3. /pkg
> 一般而言，我们在 pkg 目录下放置可以被外部程序安全导入的包

    1.  pkg 目录下的包一般会按照功能进行区分，例如 /pkg/cache 、 /pkg/conf  等
    2.  如果你的目录结构比较简单，内容也比较少，其实也可以不使用 pkg  目录，直接把上面的这些包放在最上层即可
    3.  一般而言我们应用程序 app 在最外层会包含很多文件，例如 .gitlab-ci.yml  makefile  .gitignore  等等，这种时候顶层目录会很多并且会有点杂乱，建议还是放到 /pkg  目录比较好   
### 4. /api
> API 定义的目录，如果我们采用的是 grpc 那这里面一般放的就是 proto 文件，除此之外也有可能是 openapi/swagger 定义文件，以及他们生成的文件。
### 5. /config
> 这里面一般放置配置文件文件和默认模板。
### 6. /test
> 额外的外部测试应用程序和测试数据。一般会放测试一些辅助方法和测试数据。

### 7. 项目的依赖
> 项目的依赖路径为: model -> dao -> service -> api，model struct 串联各个层，直到 api 需要做 DTO 对象转换。

    1.  model: 放对应“存储层”的结构体，是对存储的一一隐射。
    2.  dao: 数据读写层，数据库和缓存全部在这层统一处理，包括 cache miss 处理。
    3.  service: 组合各种数据访问来构建业务逻辑。
    4.  server: 依赖 proto 定义的服务作为入参，提供快捷的启动服务全局方法。
    5.  api: 定义了 API proto 文件，和生成的 stub 代码，它生成的 interface，其实现者在 service 中。
    6.  service 的方法签名因为实现了 API 的 接口定义，DTO 直接在业务逻辑层直接使用了，更有 dao 直接使用，最简化代码。
    7.  DO(Domain Object): 领域对象，就是从现实世界中抽象出来的有形或无形的业务实体。缺乏 DTO -> DO 的对象转换。

![项目目录](https://img.lailin.xyz/image/1612615164024-9156a848-53f7-4324-963a-e7e4ae110424.png)    